# 电商商品QA生成系统 (E-commerce Product QA Generator)

一个基于大模型的智能电商商品问答对生成系统，能够从多种格式的商品数据中提取信息并生成自然、多样化的问答对，模拟真实电商场景中的顾客-客服交互。

## 项目概述

本系统旨在解决电商平台中常见的问题：商品信息繁多，客服团队难以人工覆盖所有可能的客户问题。通过使用大语言模型，该系统可以：

1. 从多种格式的商品数据中智能提取结构化信息
2. 基于提取的产品信息生成多样化的问答对
3. 模拟真实电商场景中的自然对话风格
4. 提供交互式和批处理模式以适应不同场景

## 核心特点

- **多格式数据处理**：支持TXT、DOCX、XLSX、CSV、JSON等多种输入格式，甚至支持直接文本输入
- **大模型驱动解析**：使用大语言模型驱动，避免依赖硬编码规则
- **智能数据解析**：自动识别和解析商品信息，包括嵌套属性和列表数据
- **异步并行生成**：通过异步处理实现高效的QA对生成
- **多样化问题**：确保生成不同角度、不同风格的问题，避免重复
- **电商风格回答**：回答模拟真实电商客服风格，包含适当的礼貌用语和表情符号
- **完整工作流**：从原始数据到最终QA对的全流程自动化处理
- **交互式体验**：提供自然语言交互界面，简化操作流程

## 系统架构

本系统包含以下核心组件：

1. **产品数据处理器** (`product_data_processor.py`)
   - 负责解析各种格式的商品数据并转换为标准JSON
   - 支持TXT、DOCX、XLSX、CSV、JSON等格式
   - 可处理直接文本输入和文件输入

2. **异步QA生成器** (`async_qa_generator.py`)
   - 基于商品数据异步并行生成QA对
   - 确保问题多样化，避免重复
   - 生成符合电商客服风格的回答

3. **QA智能代理** (`qa_agent_simple.py`)
   - 提供交互式界面，引导用户完成整个流程
   - 基于LangGraph构建的工作流管理
   - 管理工作流状态，处理用户输入

4. **系统启动脚本** (`start_qa_system.py`)
   - 系统主入口
   - 检查依赖项和必要文件
   - 初始化QA代理系统

## 安装依赖

```bash
pip install langchain-openai langchain-core langgraph pandas openpyxl aiofiles python-docx
```

## 使用方法

### 交互式模式

最简单的方式是使用系统启动脚本：

```bash
python start_qa_system.py
```

这将启动交互式QA代理，引导您完成从数据输入到QA生成的全过程。

### 命令行批处理模式

#### 1. 处理产品数据

使用标准处理器：
```bash
python product_data_processor.py example_product.txt --output products_data.json
```

参数说明：
- 第一个参数：输入文件路径
- `--output`：输出JSON文件路径
- `--use-llm`：使用大语言模型进行解析（可选）
- `--api-key`：指定API密钥（可选）

#### 2. 生成QA对

```bash
python async_qa_generator.py --data_path products_data.json --num_pairs 5 --concurrency 3 --output qa_output.json
```

参数说明：
- `--data_path`：商品数据JSON文件路径
- `--num_pairs`：每个商品生成的QA对数量
- `--concurrency`：并发请求数
- `--output`：输出文件路径

### 工作流程

1. **启动系统**：系统会首先欢迎您并请您提供商品数据
2. **提供数据**：您可以输入文件路径或直接粘贴商品数据
3. **验证数据**：系统自动验证您的输入是否有效
   - 如果无效，系统会提供格式指南
   - 如果有效，系统会询问是否继续处理
4. **处理数据**：确认后系统会处理数据并转为标准格式
5. **设置QA数量**：系统会询问您每个商品需要生成多少对QA
6. **生成QA对**：系统会根据您的设置生成QA对
7. **查看结果**：完成后系统会展示部分QA示例并告知保存位置

## 输入格式示例

系统支持多种格式的输入，以下是一些示例：

### TXT格式 (键值对)

```
商品ID: p001
商品名称: 专业无线降噪耳机
价格: ¥1299
品牌: SoundMaster

规格:
- 蓝牙版本: 5.2
- 电池续航: 30小时

---

商品ID: p002
商品名称: 智能手表
价格: ¥899
...
```

### JSON格式

```json
[
  {
    "id": "p001",
    "name": "专业无线降噪耳机",
    "price": "¥1299",
    "brand": "SoundMaster",
    "specs": {
      "蓝牙版本": "5.2",
      "电池续航": "30小时"
    }
  },
  {
    "id": "p002",
    "name": "智能手表",
    "price": "¥899",
    ...
  }
]
```

### Excel/CSV格式

Excel或CSV文件的第一行应为表头，每行代表一个商品，重要列名包括：id, name, description, price, brand, category等。

## 输出示例

系统生成的QA对保存为JSON格式：

```json
[
  {
    "id": "p001",
    "question": "这耳机降噪效果咋样？",
    "answer": "亲～这款ProSound X7耳机的降噪效果非常出色呢🔥，它采用了智能降噪技术，可以自动调节降噪级别，无论是在嘈杂的地铁上还是安静的办公室都能为您提供沉浸式的聆听体验哦😊！特别适合需要专注工作或者享受音乐的场景呢～💕"
  },
  {
    "id": "p001",
    "question": "耳机多重啊",
    "answer": "亲，这款专业无线降噪耳机ProSound X7的重量是250g呢🎧，非常轻巧舒适，长时间佩戴也不会有压迫感哦😊！而且它采用了可折叠设计，携带起来特别方便呢～💕"
  }
]
```

## 示例会话

以下是一个典型的交互式使用场景示例：

```
QA助手: 您好！我是电商商品QA对生成助手。我可以帮您将商品信息转换为自然的问答对，模拟电商平台上顾客和客服的交流。

请提供您的商品信息，可以是TXT、DOCX、XLSX、CSV、JSON文件路径，或者直接输入商品数据。我会引导您完成整个生成过程。

您: example_product.txt

QA助手: 我已验证您提供的输入，格式有效。

输入格式有效，已检测到商品信息

您确认继续处理这些数据吗？如果确认，我将把它们转换为标准格式以便生成QA对。

您: 是的，请继续

QA助手: 商品数据处理成功！商品数据处理完成，已保存 3 个商品到 products_data.json

现在我们可以基于这些数据生成QA对。请告诉我每个商品需要生成多少对QA？

您: 5

QA助手: 好的，我将为每个商品生成5对QA。这个过程可能需要一些时间，请稍候...

QA助手: QA对生成完成，已生成 15 对QA！

所有QA对已保存到文件 qa_output.json。

示例QA对：

问题 1: 这耳机降噪效果咋样？
回答 1: 亲～这款ProSound X7耳机的降噪技术非常出色呢💫，采用了智能降噪技术，可以自动调节降噪级别，无论是嘈杂的地铁环境还是安静的办公室，都能为您提供沉浸式的聆听体验哦😊！特别适合需要专注工作或享受音乐的场景呢～💕

问题 2: 手表电池能用多久？
回答 2: 亲，这款LifeTrack Pro智能手表的续航能力很强呢🔋！正常使用情况下可以使用14天，而GPS模式下也能坚持8小时哦✨。不用担心频繁充电的问题，是出差旅行的好伴侣呢😊！

问题 3: 音箱防水吗？防尘效果怎样？
回答 3: 亲～这款SoundCube Mini蓝牙音箱的防水防尘等级达到了IP67呢💦，这意味着它不仅可以完全防尘，还能在1米深的水中浸泡30分钟而不受损害哦！非常适合户外活动、海滩、泳池派对等场景使用呢😊！您可以放心带着它去各种环境，不用担心灰尘或者水的问题呢✨

... 等共 15 对QA已生成

生成过程已完成。如需要进一步调整或有其他需求，请告诉我。

工作流已完成。您可以继续操作或输入'退出'结束程序。

您: 退出

QA助手: 感谢使用电商商品QA对生成系统，再见！
```

## 项目结构

```
.
├── start_qa_system.py         # 系统启动脚本
├── qa_agent_simple.py         # QA代理实现
├── product_data_processor.py  # 商品数据处理器
└── async_qa_generator.py      # 异步QA生成器
```

## 常见问题解决

1. **API密钥错误**：确保正确设置了API密钥，可以通过环境变量或命令行参数
2. **乱码问题**：确保所有文本文件使用UTF-8/UTF-16编码，系统会尝试自动检测编码
3. **生成速度慢**：可以调整并发数（`--concurrency`）提高效率
4. **文件格式错误**：检查输入文件是否符合要求的格式
5. **内存不足**：处理大型Excel文件时可能需要更多内存
6. **API连接问题**：如遇到API连接问题，可以尝试降低并发数或增加重试间隔

## 自定义与扩展

- 修改`FOCUS_POINTS`和`CONSTRAINTS`列表可以调整问题生成的风格和关注点
- 调整ChatOpenAI的温度参数可以控制回答的创造性和多样性
- 为不同的商品类别定制专门的提示模板可以提高QA质量
- 修改`qa_agent_simple.py`中的`model`初始化可使用不同的语言模型
- 调整`async_qa_generator.py`中的并发数可以平衡生成速度和资源使用

## 性能优化建议

1. 对于大数据集，建议将数据分批处理
2. 如果解析某些格式失败，可以先转换为更简单的格式(如CSV或JSON)
3. 使用 `--use-llm` 参数可以提高解析复杂格式的准确性，但会增加处理时间
4. 对于简单格式的文件，可以不使用LLM解析，加快处理速度
5. 降低并发数可以减少API限制风险，但会增加总处理时间

## 开发者信息

系统设计思路：
- 使用大模型驱动解析，避免硬编码规则
- 确保提取的数据与原始内容一致
- 支持多种文件格式，提高兼容性
- 生成的QA对自然多样，符合电商场景

## 许可证

[MIT License]
